syntax = "proto3";

package chat.v1;

import "chat/v1/message.proto";
import "rbt/v1alpha1/options.proto";

////////////////////////////////////////////////////////////////////////

service UsersMethods {
  rpc Add(AddRequest) returns (AddResponse) {
    option (rbt.v1alpha1.method) = {
      writer: {},
    };
  }

  rpc List(ListRequest) returns (ListResponse) {
    option (rbt.v1alpha1.method) = {
      reader: {},
    };
  }
}

////////////////////////////////////////////////////////////////////////

message Users {
  option (rbt.v1alpha1.state) = {
  };
  repeated string users = 1;
}

message AddRequest {
  string user = 1;
}

message AddResponse {

}
message ListRequest {}

message ListResponse {
  repeated string users = 1;
}
////////////////////////////////////////////////////////////////////////

service UserMethods {
  rpc Create(CreateRequest) returns (CreateResponse) {
    option (rbt.v1alpha1.method) = {
      transaction: {},
    };
  }

  rpc GetMessagesReactions(GetMessagesReactionsRequest)
      returns (GetMessagesReactionsResponse) {
    option (rbt.v1alpha1.method) = {
      reader: {},
    };
  }

  rpc AddChatbot(AddChatbotRequest) returns (AddChatbotResponse) {
    option (rbt.v1alpha1.method) = {
      transaction: {},
    };
  }

  rpc ListChatbots(ListChatbotsRequest) returns (ListChatbotsResponse) {
    option (rbt.v1alpha1.method) = {
      reader: {},
    };
  }
}

////////////////////////////////////////////////////////////////////////

message User {
  option (rbt.v1alpha1.state) = {
  };

  repeated string chatbot_ids = 1;
}

////////////////////////////////////////////////////////////////////////

message CreateRequest {}
message CreateResponse {}

////////////////////////////////////////////////////////////////////////

message GetMessagesReactionsRequest {
  int32 page = 1;
  uint32 items_per_page = 2;
}

message GetMessagesReactionsResponse {
  repeated MessageReaction reactions = 1;
}

////////////////////////////////////////////////////////////////////////

message AddChatbotRequest {
  string name = 1;
  string channel_id = 2;
  string prompt = 3;
  bool human_in_the_loop = 4;
}

message AddChatbotResponse {}

////////////////////////////////////////////////////////////////////////

message ListChatbotsRequest {}

message ListChatbotsResponse {
  repeated string chatbot_ids = 1;
}

////////////////////////////////////////////////////////////////////////